<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'none'; font-src ${cspSource}; style-src 'nonce-${nonce}'; style-src-attr 'unsafe-inline'; script-src 'nonce-${nonce}' 'unsafe-eval';"
    />
    <link rel="stylesheet" type="text/css" nonce="${nonce}" href="${path('main.css')}" />
  </head>
  <body>
    <main class="container">
      <h1>Configure Topic</h1>
      <p>Some helpful text that will encourage users to properly configure the topic.</p>
      <template data-if="this.errorMessage()">
        <div class="errors" data-text="this.errorMessage()"></div>
        </template>
      <template data-if="!this.success()">
      <form data-on-submit="this.handleSubmit(event)">
        <div class="dropdown-container">
          <label for="cleanup-policy" class="label">Cleanup Policy</label>
          <select
            id="cleanup-policy"
            class="input"
            name="cleanup.policy"
            data-prop-value="this.cleanupPolicy()"
            data-on-change="this.validateChange(event)"
          >
            <option value="delete">Delete</option>
            <option value="compact">Compact</option>
            <option value="compact,delete">Compact, Delete</option>
          </select>
          <span>Choose the retention policy to use on old log segments. Delete discards old segments when their retention time or size limit has been reached. Compact saves the last value for each unique key written to the topic.</span>
          </div>
          <div class="dropdown-container fixed-min-width">
            <label for="retention-size" class="label">Retention Size</label>
            <select
              class="input"
              id="retention-size"
              name="retention.bytes"
              data-prop-value="this.retentionSize()"
              data-on-change="this.validateChange(event)"
            >
              <option value="1048576">1 MB</option>
              <option value="1073741824">1 GB</option>
              <option value="1099511627776">1 TB</option>
              <option value="-1">Infinite</option>
            </select>
            <span>The maximum size a partition can grow to before it is discarded to free up space.</span>
          </div>
          <div class="dropdown-container fixed-min-width">
            <label for="retention-ms" class="label">Retention Time</label>
            <select
              class="input"
              id="retention-ms"
              name="retention.ms"
              data-prop-value="this.retentionMs()"
              data-on-change="this.validateChange(event)"
            >
              <option value="3600000">1 Hour</option>
              <option value="86400000">1 Day</option>
              <option value="604800000">1 Week</option>
              <option value="2592000000">1 Month</option>
              <option value="31536000000">1 Year (365 days)</option>
              <option value="-1">Infinite</option>
            </select>
            <span>The amount of time to retain data.</span>
          </div>
          <div class="dropdown-container fixed-min-width">
            <label for="max-message-bytes" class="label">Max Message Size (Bytes)</label>
            <input
              class="input"
              id="max-message-bytes"
              name="max.message.bytes"
              type="text"
              data-prop-value="this.maxMessageBytes()"
              data-on-change="this.validateChange(event)"
            />
            <span>The maximum message size that can be appended to this topic, in bytes.</span>
          </div>
        </div>
        <input class="button" type="submit" value="Save" /><button type="button" class="button secondary">Cancel</button>
      </form>
      </template>
      <template data-if="this.success()">
        <div class="info">Topic configuration saved successfully.</div>
      </template>
    </main>

    <script type="module" nonce="${nonce}" src="${path('main.js')}"></script>
    <script type="module" nonce="${nonce}" src="${path('topic-config-form.js')}"></script>
    <style nonce="${nonce}">
      body {
        max-width: 1000px;
        font-size: 14px;
      }
      .container {
        padding: 60px 80px;
        display: flex;
        flex-direction: column;
        gap: 16px;
      }
      .container > * {
        margin: unset;
      }
      h1 {
        font-size: 26px;
      }
      h2 {
        font-size: 16px;
      }
      form {
        display: flex;
        flex-direction: column;
        align-items: start;
        gap: 20px;
        margin-top: 26px;
      }
      .input-container {
        display: flex;
        align-items: center;
        gap: 16px;
        width: 100%;
        font-weight: 500;
      }
      @media screen and (max-width: 1000px) {
        .input-container {
          flex-wrap: wrap;
          gap: 8px;
          padding-bottom: 5px;
        }
      }
      input:not([type="submit"]),
      .dropdown > * {
        width: 250px;
      }
      .dropdown {
        display: flex;
        flex-direction: column;
        gap: 16px;
        align-items: start;
      }
      .description {
        font-weight: 700;
        color: var(--vscode-descriptionForeground);
        font-size: 12px;
      }
      .dropdown > label > vscode-dropdown {
        width: 100%;
      }
      .info {
        color: var(--vscode-descriptionForeground);
        font-weight: 700;
        font-style: italic;
      }
    </style>
  </body>
</html>
